<tarea nombre="Autoriza Adecuación Presupuestaria Comprometido" id="bP" autor="Julio DH" fechaModificacion="" modificacionEfectuada="Versión Inicial" requisitosInstalacion="No" version="1.0.1">
    <pagina nombre="Autoriza Adecuación Presupuestaria Comprometido" id="bP">
        <nivel nombre="buscaPeriodo" id="bP" interactivo="false">
            <componente tipo="cursor" nombre="bP" id="bP">
                <tabla schema="catalog" nombre="periodo">
                    <campo name="id_unidad_responsable" filtroCampo="id_unidad_responsable" filtroOperador="=" filtroValor="$config.ur$"/>
                    <campo name="estatus" filtroCampo="estatus" filtroOperador="=" filtroValor="true"/>
                    <campo name="id_estatus" filtroCampo="id_estatus" filtroOperador="=" filtroValor="3"/>
                    <campo name="id_periodo"/>
                    <campo name="id_separador"/>
                    <campo name="ur" local="true" type="long" calc="$inParam.ur$"/>
                    <campo name="id_compromiso" local="true" type="long" calc="$inParam.id_compromiso_anual$"/>
                    <campo name="id_adecuacion_compromisos_anuales" local="true" type="long" calc="$inParam.id_adecuacion_compromisos_anuales$"/>
                    <campo name="id_mov_adecuacion_compromisos_anuales" local="true" type="long" calc="$inParam.id_mov_adecuacion_compromisos_anuales$"/>
                </tabla>
            </componente>
        </nivel>
        <nivel nombre="barrido_Compromisos Anuales" id="bCA" interactivo="false">
            <componente tipo="cursor" nombre="Detalle de Compromisos Anuales" id="bCA">
                <tabla schema="operation" nombre="compromisos_anual">
                    <campo name="ur" text="" filtroCampo="ur" filtroOperador="=" filtroValor="%bP.bP.id_unidad_responsable%" llaveForanea="false"/>
                    <campo name="id_periodo" text="" filtroCampo="id_periodo" filtroOperador="=" filtroValor="%bP.bP.id_periodo%" llaveForanea="false"/>
                    <campo name="id_compromiso" filtroCampo="id_compromiso" filtroOperador="=" filtroValor="%bP.bP.id_compromiso%" />
                    <campo name="id_duep" text=""/>
                    <campo name="id_fondo_contable" text=""/>
                    <campo name="id_tipo_compromiso" text="" llaveForanea="false"/>
                </tabla>
            </componente>
        </nivel>
        <nivel nombre="Gestión de Adecuaciones de  Compromisos Anuales" id="aL" mostrarNivelAnterior="false" mostrarProximoNivel="false" ejecutar="%bP.bP.id_mov_adecuacion_compromisos_anuales%==1">
            <componente tipo="tabla" nombre="Ampliación Líquida" id="aL" accionDefault="seleccionar" mostrarAgregar="false" mostrarEliminar="false" mostrarEditar="false">
                <tabla schema="operation" nombre="compromisos_anual_det" id="aBl" tituloDetalle="Alta de Bloque">
                    <campo name="ur" text="UR" filtroCampo="ur" filtroOperador="=" filtroValor="%bP.bP.ur%" llaveForanea="false" columna-visible="false" visible="false"/>
                    <campo name="id_compromiso" text="id_compromiso" filtroCampo="id_compromiso" filtroOperador="=" filtroValor="%bP.bP.id_compromiso%" llaveForanea="false" columna-visible="false" visible="false"/>
                    <campo name="id_detalle_compromiso" text="Renglón" width="100" habilitado="false" visible="false"/>
                    <campo name="id_periodo" text="Año" width="100" filtroCampo="id_periodo" filtroOperador="=" filtroValor="%bP.bP.id_periodo%" llaveForanea="false" columna-visible="true" visible="false"/>
                    <campo name="articulo" text="Artículo" width="140" habilitado="false" descripcionForanea="clave_articulo,descripcion" descripcionForaneaTabla="clave_articulo,descripcion" columnas="3" margen-izquierdo="2" columna-visible="false"/><!--llavesFijas="estatus='Activo' AND afectable=true"-->
                    <campo name="clave_presupuestal" text="Clave Presupuestal" width="270" llaveForanea="false" habilitado="false" columnas="3" margen-derecho="2"/>
                    <campo name="importe_ampliacion_com" text="Importe de Ampliación del Compromiso" formatoMoneda="true" width="290" columnas="3" margen-izquierdo="2"/>
                    <campo name="por_calendarizar" text="Por Calendarizar" width="150" borrarValor="false" habilitado="false" columnas="3" margen-derecho="2" columna-visible="false"/>
                    <campo name="prorratear" text="Prorratear" width="150" columnas="3" margen-izquierdo="2" columna-visible="false"/>
                    <campo name="importe_total" text="Importe Aprobado" formatoMoneda="true" width="150" columnas="3" visible="false"/>
                    <campo name="presupuesto_comprometer" text="Comprometido" formatoMoneda="true" width="150" visible="false"/>
                    <campo name="presupuesto_p_ejercer" text="Por Ejercer" formatoMoneda="true" width="140" visible="false"/>
                    <!--<campo name="mes_actual" text="mes_actual" local="true" type="long" calc="12-@castTo(@fechaSistema('MM'),'long')" visible="false" columna-visible="false"/>-->
                    <!--<campo name="meses_restantes" text="meses_restantes" local="true" type="decimal" calcCliente="@ifThenElse(%importe_ampliacion_com%==null,0,%importe_ampliacion_com%)/@castTo(%mes_actual%,'long')" visible="false" columna-visible="false"/>-->
                    <!-- <campo name="enero" text="Enero" width="120" borrarValor="false" columna-visible="false"/>
                    <campo name="febrero" text="Febrero" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="marzo" text="Marzo" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="abril" text="Abril" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="mayo" text="Mayo" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="junio" text="Junio" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="julio" text="Julio" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="agosto" text="Agosto" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="septiembre" text="Septiembre" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="octubre" text="Octubre" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="noviembre" text="Noviembre" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="diciembre" text="Diciembre" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/> -->
                </tabla>
                <estilos>
                    <boton nombre="grabar" visible="true" texto="Continuar" columnas="2" margen-izquierdo="4"/>
                    <boton nombre="formulario" visible="true" texto="Continuar" columnas="2" margen-izquierdo="4"/>
                </estilos>
                <acciones>
                    <accion nombre="grabar" hacer="saltar siguiente nivel"/>
                </acciones>
            </componente>
        </nivel>
        <nivel nombre="Reporte de Adecuaciones de Compromisos Anuales" id="report_AL" mostrarNivelAnterior="false" mostrarProximoNivel="true" ejecutar="%bP.bP.id_mov_adecuacion_compromisos_anuales%==1">
            <componente tipo="reporte" nombre="Reporte Ampliación Líquida" id="report_AL">
                <reporte nombre="R_Ejercicio_Pres_CA_Jo">
                    <campo name="ur" type="long" calc="%bP.bP.ur%"/>
                    <campo name="periodo" type="long" calc="%bP.bP.id_periodo%"/>
                    <campo name="idCompromiso" type="long" calc="%bP.bP.id_compromiso%"/>
                    <campo name="id_adecuacion_compromisos_anuales" type="long" calc="%bP.bP.id_adecuacion_compromisos_anuales%"/>
                    <campo name="usuario" type="string" calc="$protocolarios.user$"/>
                </reporte>
            </componente>
        </nivel>
        <nivel nombre="Gestión de Adecuaciones de  Compromisos Anuales" id="rL" mostrarNivelAnterior="false" mostrarProximoNivel="false" ejecutar="%bP.bP.id_mov_adecuacion_compromisos_anuales%==2">
            <componente tipo="tabla" nombre="Reducción Líquida " id="rL" accionDefault="seleccionar" mostrarAgregar="false" mostrarEliminar="false" mostrarEditar="false">
                <tabla schema="operation" nombre="compromisos_anual_det" id="aBl">
                    <campo name="ur" text="UR" filtroCampo="ur" filtroOperador="=" filtroValor="%bP.bP.ur%" llaveForanea="false" columna-visible="false" visible="false"/>
                    <campo name="id_compromiso" text="id_compromiso" filtroCampo="id_compromiso" filtroOperador="=" filtroValor="%bP.bP.id_compromiso%" llaveForanea="false" columna-visible="false" visible="false"/>
                    <campo name="id_detalle_compromiso" text="Renglón" width="100" habilitado="false" visible="false"/>
                    <campo name="id_periodo" text="Año" width="100" filtroCampo="id_periodo" filtroOperador="=" filtroValor="%bP.bP.id_periodo%" llaveForanea="false" columna-visible="true" visible="false"/>
                    <campo name="articulo" text="Artículo" width="140" habilitado="false" descripcionForanea="clave_articulo,descripcion" descripcionForaneaTabla="clave_articulo,descripcion" columnas="3" margen-izquierdo="2" columna-visible="false"/><!--llavesFijas="estatus='Activo' AND afectable=true"-->
                    <campo name="clave_presupuestal" text="Clave Presupuestal" width="270" llaveForanea="false" habilitado="false" columnas="3" margen-derecho="2"/>
                    <campo name="presupuesto_comprometer" text="Comprometido" formatoMoneda="true" width="150" visible="false"/>
                    <campo name="importe_devengado" text="Devengado" formatoMoneda="true" width="150" visible="false"/>
                    <campo name="saldo_compromiso" text="Saldo del Compromiso" formatoMoneda="true" width="200" visible="false"/>
                    <campo name="importe_reduccion_com" text="Reducciones por Autorizar" formatoMoneda="true" width="290" columnas="3" margen-izquierdo="2" mostrarAcumulado="false"/>
                    <campo name="prorratear" text="Prorratear" width="150" columnas="3" margen-derecho="2" columna-visible="false"/>
                    <campo name="mes_actual" text="mes_actual" local="true" type="long" calc="12-@castTo(@fechaSistema('MM'),'long')" visible="false" columna-visible="false"/>
                    <campo name="meses_restantes" text="meses_restantes" local="true" type="decimal" calcCliente="@ifThenElse(%importe_ampliacion_com%==null,0,%importe_ampliacion_com%)/@castTo(%mes_actual%,'long')" visible="false" columna-visible="false"/>
                    <!-- <campo name="enero" text="Enero" width="120" borrarValor="false" columna-visible="false"/>
                    <campo name="febrero" text="Febrero" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="marzo" text="Marzo" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="abril" text="Abril" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="mayo" text="Mayo" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="junio" text="Junio" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="julio" text="Julio" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="agosto" text="Agosto" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="septiembre" text="Septiembre" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="octubre" text="Octubre" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="noviembre" text="Noviembre" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/>
                    <campo name="diciembre" text="Diciembre" width="120" borrarValor="false" columnas="3" margen-izquierdo="5" columna-visible="false"/> -->
                </tabla>
                <estilos>
                    <boton nombre="grabar" visible="true" texto="Continuar" columnas="2" margen-izquierdo="4"/>
                    <boton nombre="formulario" visible="true" texto="Continuar" columnas="2" margen-izquierdo="4"/>
                </estilos>
                <acciones>
                    <accion nombre="grabar" hacer="saltar siguiente nivel"/>
                </acciones>
            </componente>
        </nivel>
        <nivel nombre="Reporte de Adecuaciones de Compromisos Anuales" id="report_RL" mostrarNivelAnterior="false" mostrarProximoNivel="true" ejecutar="%bP.bP.id_mov_adecuacion_compromisos_anuales%==2">
            <componente tipo="reporte" nombre="Reporte Reducción Líquida" id="report_RL">
                <reporte nombre="R_Ejercicio_Pres_CA_Jo_Reduccion">
                    <campo name="ur" type="long" calc="%bP.bP.ur%"/>
                    <campo name="periodo" type="long" calc="%bP.bP.id_periodo%"/>
                    <campo name="idCompromiso" type="long" calc="%bP.bP.id_compromiso%"/>
                    <campo name="id_adecuacion_compromisos_anuales" type="long" calc="%bP.bP.id_adecuacion_compromisos_anuales%"/>
                    <campo name="usuario" type="string" calc="$protocolarios.user$"/>
                </reporte>
            </componente>
        </nivel>
        <nivel nombre="Gestión de Adecuaciones de  Compromisos Anuales" id="tP" mostrarNivelAnterior="false" mostrarProximoNivel="false" ejecutar="%bP.bP.id_mov_adecuacion_compromisos_anuales%==3">
            <componente tipo="tabla" nombre="Traspaso Presupuestal" id="tP" accionDefault="seleccionar" mostrarAgregar="false" mostrarEliminar="false" mostrarEditar="false">
                <tabla schema="operation" nombre="compromisos_anual_det" id="aBl" >
                    <campo name="ur" text="UR" filtroCampo="ur" filtroOperador="=" filtroValor="%bP.bP.ur%" llaveForanea="false" columna-visible="false" visible="false"/>
                    <campo name="id_compromiso" text="id_compromiso" filtroCampo="id_compromiso" filtroOperador="=" filtroValor="%bP.bP.id_compromiso%" llaveForanea="false" columna-visible="false" visible="false"/>
                    <campo name="id_detalle_compromiso" text="Renglón" width="100" habilitado="false" visible="false"/>
                    <campo name="id_periodo" text="Año" width="100" filtroCampo="id_periodo" filtroOperador="=" filtroValor="%bP.bP.id_periodo%" llaveForanea="false" columna-visible="true" visible="false"/>
                    <campo name="articulo" text="Artículo" width="140" habilitado="false" descripcionForanea="clave_articulo,descripcion" descripcionForaneaTabla="clave_articulo,descripcion" columnas="3" margen-izquierdo="2" columna-visible="false"/><!--llavesFijas="estatus='Activo' AND afectable=true"-->
                    <campo name="clave_presupuestal" text="Clave Presupuestal Origen" width="270" llaveForanea="false" habilitado="false" columnas="3" margen-derecho="2"/>
                    <campo name="clave_presupuestal_destino_local" text="Clave Presupuestal Destino" width="270" columnas="3" margen-izquierdo="2" descripcionForanea="clave_presupuestal" descripcionForaneaTabla="clave_presupuestal" autoFiltradoEsquema="operation" autoFiltradoTabla="presupuesto_egresos_mes_det" autoFiltradoLlave="clave_presupuestal" autoFiltradoDescripcion="clave_presupuestal" autoFiltrado="true" columna-visible="false"  habilitado="true" local="true" type="string"/>
                    <campo name="clave_presupuestal_destino" text="" calcCliente="%clave_presupuestal_destino_local%" visible="false" columna-visible="false"/>
                    <campo name="presupuesto_comprometer" text="Comprometido" formatoMoneda="true" width="150" visible="false"/>
                    <campo name="importe_devengado" text="Devengado" formatoMoneda="true" width="150" visible="false"/>
                    <campo name="saldo_compromiso" text="Saldo del Compromiso" formatoMoneda="true" width="200" visible="false"/>
                </tabla>
                <estilos>
                    <boton nombre="grabar" visible="true" texto="Continuar" columnas="2" margen-izquierdo="4"/>
                    <boton nombre="formulario" visible="true" texto="Continuar" columnas="2" margen-izquierdo="4"/>
                </estilos>
                <acciones>
                    <accion nombre="grabar" hacer="saltar siguiente nivel"/>
                </acciones>
            </componente>
        </nivel>
        <nivel nombre="Reporte Traspaso Presupuestal" id="report_TP" mostrarNivelAnterior="false" mostrarProximoNivel="true" ejecutar="%bP.bP.id_mov_adecuacion_compromisos_anuales%==3">
            <componente tipo="reporte" nombre="Reporte Traspaso Presupuestal" id="report_TP">
                <reporte nombre="repor_traspaso_jsus">
                    <campo name="ur" type="long" calc="%bP.bP.ur%"/>
                    <campo name="periodo" type="long" calc="%bP.bP.id_periodo%"/>
                    <campo name="idCompromiso" type="long" calc="%bP.bP.id_compromiso%"/>
                    <campo name="usuario" type="string" calc="$protocolarios.user$"/>
                </reporte>
            </componente>
        </nivel>
         <nivel nombre="Autoriza Compromisos Anuales" id="aCA" mostrarNivelAnterior="false" mostrarProximoNivel="false">
            <componente tipo="formulario" nombre="Detalle de Compromisos Anuales" id="aCA" accionDefault="editar">
                <tabla schema="operation" nombre="compromisos_anual">
                    <campo name="ur" calc="%bP.bP.id_unidad_responsable%" llaveForanea="false" visible="false"/>
                    <campo name="id_periodo" calc="%bP.bP.id_periodo%" llaveForanea="false" visible="false"/>
                    <campo name="id_compromiso" calc="%bP.bP.id_compromiso%" llaveForanea="false" visible="false"/>
                    <campo name="autorizacion_adecuacion_com" text="Autorizar" columnas="1" margen-izquierdo="4"/>
                    <campo name="obs_autorizacion_adecuacion_com" text="Observaciones" width="100" height="100" columnas="6" margen-izquierdo="2" interaccion-visible="%autorizacion_adecuacion_com%==false" visible="false"/>
                </tabla>
                <estilos>
                    <boton nombre="grabar" visible="true" texto="Continuar" columnas="2" margen-izquierdo="4"/>
                </estilos>
                <acciones>
                    <accion nombre="grabar" hacer="saltar siguiente nivel"/>
                </acciones>
                <confirmaciones>
                    <confirmacion confirmacionInteraccion="%aCA.aCA.autorizacion_adecuacion_com%==true" confirmacionTitulo="'Autorizar Solicitud'" confirmacionMensaje="'¿Desea Autorizar Compromiso?'" tipo="avanzar"/>
                </confirmaciones>
            </componente>
        </nivel>
        <nivel nombre="Instancia Validdor" id="InstanciaVal" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==false">
           <componente tipo="solicitud" nombre="EnvioParametrosDynamo" id="InstanciaVal">
               <parametros url="$config.request$" metodo="POST" accion="agregarMensaje" tipo="json">
                   <parametro name="enterprise" calc="$protocolarios.enterprise$"/>
                   <parametro name="process" calc="$protocolarios.process$"/>
                   <parametro name="version" calc="$protocolarios.version$"/>
                   <parametro name="user" calc="$protocolarios.user$"/>
                   <parametro name="instanceId" calc="$protocolarios.instance$"/> 
                   <parametro name="message" calc="%aCA.aCA.obs_autorizacion_adecuacion_com%"/>
                   <parametro name="type" calc="'1'"/>
               </parametros> 
           </componente>
        </nivel>
        <nivel nombre="negociaInstanciaMensaje" id="negociaInstanciaMensaje" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==false">
           <componente tipo="solicitud" nombre="Enlace con dynamo" id="negociaInstanciaMensaje">
                <parametros url="$config.request$" metodo="POST" accion="negociarInstancia" tipo="json">
                    <parametro name="enterprise" calc="$protocolarios.enterprise$"/>
                    <parametro name="process" calc="$protocolarios.process$"/>
                    <parametro name="version" calc="$protocolarios.version$"/>
                    <parametro name="instance" calc="$protocolarios.instance$"/>
                    <parametro name="user" calc="$protocolarios.user$"/>
                    <parametro name="url" calc="$protocolarios.url$"/>
                    <parametro name="reiniciarInstancia" calc="'true'" />
                </parametros>
            </componente>
        </nivel>
        <!-- ENCABEZADO DE LA PÓLIZA Ampliación-->
        <nivel id="obSeparador" nombre="obSeparador" interactivo="false">
            <componente tipo="cursor" id="obSeparador" nombre="obSeparador">
                <tabla schema="catalog" nombre="separador">
                    <campo name="id_separador" filtroCampo="id_separador" filtroOperador="=" filtroValor="%bP.bP.id_separador%"/>
                    <campo name="caracter"/>
                </tabla>
            </componente>
        </nivel>
        <nivel id="bU" nombre="barreUsuarios" interactivo="false">
            <componente id="bU" nombre="barreUsuarios" tipo="cursor">
                <tabla schema="entity" nombre="usuario">
                    <campo name="id_unidad_responsable" filtroCampo="id_unidad_responsable" filtroOperador="=" filtroValor="$config.ur$"/>
                    <campo name="id_usuario"/>
                    <campo name="nombre_usuario" filtroCampo="nombre_usuario" filtroOperador="=" filtroValor="$protocolarios.user$"/>
                </tabla>
            </componente>
        </nivel>
        <nivel id="nlGenEncabezadoPolizaCom" nombre="Generación del Encabezado de la Póliza" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true">
            <componente id="cpGenEncabezadoPolizaCom" nombre="Generación del Encabezado de la Póliza" tipo="altaDirect">
                <tabla schema="operation" nombre="movimientos_auxiliares">
                   <campo name="ur" calc="$inParam.ur$"/> 
                   <campo name="periodo" calc="$inParam.id_periodo$" />
                   <campo name="folio_movimiento_auxiliar" generacion="@prox()+1" autogenerado="true"/>
                   <campo name="fecha_poliza" calc="@fechaSistema()"/>
                   <campo name="id_catalogo"/>
                   <campo name="duep_origen"/>
                   <campo name="fondo_contable" calc="%bCA.bCA.id_fondo_contable%"/>
                   <campo name="concepto_general" calc="'Póliza del Presupuesto de Egresos Comprometidos'+' '+%bCA.bCA.id_duep%"/>
                   <campo name="momento_contable" calc="4"/>
                   <campo name="estatus_poliza" calc="2"/>
                   <campo name="origen_poliza" calc="1"/>
                   <campo name="tipo_poliza" calc="1"/>
                </tabla>
            </componente>
        </nivel>
        <nivel id="nlBarridoDetalleDUEPCom" nombre="Barrido de los Detalles" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true">
            <componente id="cpBarridoDetalleDUEPCom" nombre="Barrido de los Detalles" tipo="cursor">
                <tabla schema="operation" nombre="compromisos_anual_det">
                    <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="$inParam.ur$"/>
                    <campo name="id_periodo" filtroCampo="id_periodo" filtroOperador="=" filtroValor="$inParam.id_periodo$"/>
                    <campo name="id_compromiso" filtroCampo="id_compromiso" filtroOperador="=" filtroValor="$inParam.id_compromiso_anual$"/>
                    <campo name="clave_presupuestal"/>
                    <campo name="importe_ampliacion_com"/>
                    <campo name="importe_reduccion_com"/>
                </tabla>
                <nivel id="altaEjercido" nombre="Actualiza presupuesto ejercido" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true AND %bP.bP.id_mov_adecuacion_compromisos_anuales%==1">
            <componente id="altaEjercido" nombre="Actualiza presupuesto ejercido" tipo="cursor">
                <tabla schema="operation" nombre="presupuesto_egresos_mes_det">
                    <campo name="id_unidad_responsable" filtroCampo="id_unidad_responsable" filtroOperador="=" filtroValor="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.ur%"/>
                    <campo name="id_periodo" filtroCampo="id_periodo" filtroOperador="=" filtroValor="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.periodo%"/>
                    <campo name="clave_presupuestal" filtroCampo="clave_presupuestal" filtroOperador="=" filtroValor="%nlBarridoDetalleDUEPCom.cpBarridoDetalleDUEPCom.clave_presupuestal%"/>
                    <campo name="mes" filtroCampo="mes" filtroOperador="=" filtroValor="@fechaSistema('MM')"/>
                    <campo name="presupuesto_comprometido" 
                    calc="@consultaDirec('SELECT '+%altaEjercido.altaEjercido.presupuesto_comprometido%+' + '+ %nlBarridoDetalleDUEPCom.cpBarridoDetalleDUEPCom.importe_ampliacion_com%+' AS suma','suma','numeric','MAGNITUS')"/>
                    </tabla>
            </componente>
        </nivel>
                <!-- INGRESA EL CARGO A LA PÓLIZA AMPLIACION-->
                <nivel id="altaDetalleDirecCargoCom" nombre="Alta Detalle Cargo" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true AND %bP.bP.id_mov_adecuacion_compromisos_anuales%==1">
                    <componente id="altaDetalleDirecCargo" nombre="altaDetalleDirecCargo" tipo="altaDirect">
                        <tabla schema="operation" nombre="detalle_movimientos_auxiliares">
                            <campo name="ur" calc="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.ur%" />
                            <campo name="id_periodo" calc="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.periodo%" />
                            <campo name="id_movimiento_auxiliar" calc="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.folio_movimiento_auxiliar%" />
                            <campo name="id_detalle_movimiento_auxiliar" generacion="@prox()+1" autogenerado="true"/>
                            <campo name="clave_presupuestal" calc="%nlBarridoDetalleDUEPCom.cpBarridoDetalleDUEPCom.clave_presupuestal%" />
                            <campo name="clave_cuenta_contable" calc="@concatenar('8'+%obSeparador.obSeparador.caracter%+
                            '2'+%obSeparador.obSeparador.caracter%+
                            '4'+%obSeparador.obSeparador.caracter%+
                            '0'+%obSeparador.obSeparador.caracter%+
                            '0'+%obSeparador.obSeparador.caracter%+
                            '01'+%obSeparador.obSeparador.caracter%+
                            '00000'+%obSeparador.obSeparador.caracter%+'000')" />
                            <campo name="importe_cargo" calc="%nlBarridoDetalleDUEPCom.cpBarridoDetalleDUEPCom.importe_ampliacion_com%"/>
                            <campo name="concepto_bloque" calc="' Presupuesto de Egresos Comprometido'"/>
                            <campo name="fecha_registro" calc="@fechaSistema()" />
                            <campo name="ultimo_usuario_modificador" calc="%bU.bU.id_usuario%"/>
                            <campo name="tipo_detalle" calc="1" llaveForanea="false"/>
                        </tabla>
                    </componente>
                </nivel>
                <!-- INGRESA EL ABONO A LA PÓLIZA AMPLIACION-->
                <nivel id="altaDetalleDirecAbonoCom" nombre="AltaDetalleDirecAbono" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true AND %bP.bP.id_mov_adecuacion_compromisos_anuales%==1">
                    <componente id="altaDetalleDirecAbono" nombre="altaDetalleDirecAbono" tipo="altaDirect">
                        <tabla schema="operation" nombre="detalle_movimientos_auxiliares">
                            <campo name="ur" calc="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.ur%" />
                            <campo name="id_periodo" calc="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.periodo%" />
                            <campo name="id_movimiento_auxiliar" calc="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.folio_movimiento_auxiliar%" />
                            <campo name="id_detalle_movimiento_auxiliar" generacion="@prox()+1" autogenerado="true"/>
                            <campo name="clave_presupuestal" calc="%nlBarridoDetalleDUEPCom.cpBarridoDetalleDUEPCom.clave_presupuestal%"/>
                            <campo name="clave_cuenta_contable" calc="@concatenar('8'+%obSeparador.obSeparador.caracter%+
                            '2'+%obSeparador.obSeparador.caracter%+
                            '2'+%obSeparador.obSeparador.caracter%+
                            '0'+%obSeparador.obSeparador.caracter%+
                            '0'+%obSeparador.obSeparador.caracter%+
                            '01'+%obSeparador.obSeparador.caracter%+
                            '00000'+%obSeparador.obSeparador.caracter%+'000')" />
                            <campo name="importe_abono" calc="%nlBarridoDetalleDUEPCom.cpBarridoDetalleDUEPCom.importe_ampliacion_com%"/>
                            <campo name="concepto_bloque" calc="'Presupuesto de Egresos por Ejercer'"/>
                            <campo name="fecha_registro" calc="@fechaSistema()" />
                            <campo name="ultimo_usuario_modificador" calc="%bU.bU.id_usuario%"/>
                            <campo name="tipo_detalle" calc="1" llaveForanea="false"/>
                        </tabla>
                    </componente>
                </nivel>
                <!-- INGRESA EL CARGO A LA PÓLIZA REDUCCION-->
                <nivel id="altaDetalleDirecCargoCom_R" nombre="Alta Detalle Cargo" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true AND %bP.bP.id_mov_adecuacion_compromisos_anuales%==2">
                    <componente id="altaDetalleDirecCargoCom_R" nombre="altaDetalleDirecCargo" tipo="altaDirect">
                        <tabla schema="operation" nombre="detalle_movimientos_auxiliares">
                            <campo name="ur" calc="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.ur%" />
                            <campo name="id_periodo" calc="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.periodo%" />
                            <campo name="id_movimiento_auxiliar" calc="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.folio_movimiento_auxiliar%" />
                            <campo name="id_detalle_movimiento_auxiliar" generacion="@prox()+1" autogenerado="true"/>
                            <campo name="clave_presupuestal" calc="%nlBarridoDetalleDUEPCom.cpBarridoDetalleDUEPCom.clave_presupuestal%" />
                            <campo name="clave_cuenta_contable" calc="@concatenar('8'+%obSeparador.obSeparador.caracter%+
                            '2'+%obSeparador.obSeparador.caracter%+
                            '4'+%obSeparador.obSeparador.caracter%+
                            '0'+%obSeparador.obSeparador.caracter%+
                            '0'+%obSeparador.obSeparador.caracter%+
                            '01'+%obSeparador.obSeparador.caracter%+
                            '00000'+%obSeparador.obSeparador.caracter%+'000')" />
                            <campo name="importe_cargo" calc="%nlBarridoDetalleDUEPCom.cpBarridoDetalleDUEPCom.importe_reduccion_com%"/>
                            <campo name="concepto_bloque" calc="' Presupuesto de Egresos Comprometido'"/>
                            <campo name="fecha_registro" calc="@fechaSistema()" />
                            <campo name="ultimo_usuario_modificador" calc="%bU.bU.id_usuario%"/>
                            <campo name="tipo_detalle" calc="1" llaveForanea="false"/>
                        </tabla>
                    </componente>
                </nivel>
                <!-- INGRESA EL ABONO A LA PÓLIZA REDUCCION-->
                <nivel id="altaDetalleDirecAbonoCom_R" nombre="AltaDetalleDirecAbono" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true AND %bP.bP.id_mov_adecuacion_compromisos_anuales%==2">
                    <componente id="altaDetalleDirecAbonoCom_R" nombre="altaDetalleDirecAbono" tipo="altaDirect">
                        <tabla schema="operation" nombre="detalle_movimientos_auxiliares">
                            <campo name="ur" calc="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.ur%" />
                            <campo name="id_periodo" calc="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.periodo%" />
                            <campo name="id_movimiento_auxiliar" calc="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.folio_movimiento_auxiliar%" />
                            <campo name="id_detalle_movimiento_auxiliar" generacion="@prox()+1" autogenerado="true"/>
                            <campo name="clave_presupuestal" calc="%nlBarridoDetalleDUEPCom.cpBarridoDetalleDUEPCom.clave_presupuestal%"/>
                            <campo name="clave_cuenta_contable" calc="@concatenar('8'+%obSeparador.obSeparador.caracter%+
                            '2'+%obSeparador.obSeparador.caracter%+
                            '2'+%obSeparador.obSeparador.caracter%+
                            '0'+%obSeparador.obSeparador.caracter%+
                            '0'+%obSeparador.obSeparador.caracter%+
                            '01'+%obSeparador.obSeparador.caracter%+
                            '00000'+%obSeparador.obSeparador.caracter%+'000')" />
                            <campo name="importe_abono" calc="%nlBarridoDetalleDUEPCom.cpBarridoDetalleDUEPCom.importe_reduccion_com%"/>
                            <campo name="concepto_bloque" calc="'Presupuesto de Egresos por Ejercer'"/>
                            <campo name="fecha_registro" calc="@fechaSistema()" />
                            <campo name="ultimo_usuario_modificador" calc="%bU.bU.id_usuario%"/>
                            <campo name="tipo_detalle" calc="1" llaveForanea="false"/>
                        </tabla>
                    </componente>
                </nivel>
        <!--        <nivel id="altaEjercido" nombre="Actualiza presupuesto ejercido" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true AND %bP.bP.id_mov_adecuacion_compromisos_anuales%==2">-->
        <!--    <componente id="altaEjercido" nombre="Actualiza presupuesto ejercido" tipo="cursor">-->
        <!--        <tabla schema="operation" nombre="presupuesto_egresos_mes_det">-->
        <!--            <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.ur%"/>-->
        <!--            <campo name="id_periodo" filtroCampo="id_periodo" filtroOperador="=" filtroValor="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.periodo%"/>-->
        <!--            <campo name="clave_presupuestal" filtroCampo="clave_presupuestal" filtroOperador="=" filtroValor="%nlBarridoDetalleDUEPCom.cpBarridoDetalleDUEPCom.clave_presupuestal%"/>-->
        <!--            <campo name="mes" filtroCampo="mes" filtroOperador="=" filtroValor="@fechaSistema('MM')"/>-->
       
        <!--            <campo name="presupuesto_comprometido"  calc="@consultaDirec('SELECT '+%altaEjercido.altaEjercido.presupuesto_ejercido%+' - '+ %nlBarridoDetalleDUEPCom.cpBarridoDetalleDUEPCom.importe_reduccion_com%+' AS suma','suma','numeric','MAGNITUS')"/>-->
        <!--            </tabla>-->
        <!--    </componente>-->
        <!--</nivel>-->
            </componente>
        </nivel>
        <nivel nombre="acumula" id="acumula" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true">
            <componente tipo="cursor" nombre="acumula" id="acumula">
                <tabla schema="operation" nombre="compromisos_anual_det">
                    <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="$inParam.ur$"/>
                    <campo name="id_periodo" filtroCampo="id_periodo" filtroOperador="=" filtroValor="$inParam.id_periodo$"/>
                    <campo name="id_compromiso" filtroCampo="id_compromiso" filtroOperador="=" filtroValor="$inParam.id_compromiso_anual$"/>
                    <campo name="id_detalle_compromiso"/>
                    <campo name="por_calendarizar"/>
                    <campo name="importe_reduccion_com"/>
                    <campo name="importe_total" calc="%acumula.acumula.por_calendarizar%"/>
                    <campo name="acumulado" local="true" type="double" calc="$sumatoria.por_calendarizar$"/>
                    <campo name="acumulado_IR" local="true" type="double" calc="$sumatoria.por_calendarizar$"/>
                </tabla>
            </componente>
        </nivel>
        <nivel nombre="acumulaS" id="acumulaS" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true AND %bP.bP.id_mov_adecuacion_compromisos_anuales%==1">
            <componente tipo="cursor" nombre="acumulaS" id="acumulaS">
                <tabla schema="operation" nombre="compromisos_anual">
                    <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="$inParam.ur$"/>
                    <campo name="id_periodo" filtroCampo="id_periodo" filtroOperador="=" filtroValor="$inParam.id_periodo$"/>
                    <campo name="id_compromiso" filtroCampo="id_compromiso" filtroOperador="=" filtroValor="$inParam.id_compromiso_anual$"/>
                    <campo name="total_comprometido" calc="%acumula.acumula.acumulado%"/>
                </tabla>
            </componente>
        </nivel>
        <nivel nombre="acumulaS_R" id="acumulaS_R" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true AND %bP.bP.id_mov_adecuacion_compromisos_anuales%==2">
            <componente tipo="cursor" nombre="acumulaS_R" id="acumulaS_R">
                <tabla schema="operation" nombre="compromisos_anual">
                    <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="$inParam.ur$"/>
                    <campo name="id_periodo" filtroCampo="id_periodo" filtroOperador="=" filtroValor="$inParam.id_periodo$"/>
                    <campo name="id_compromiso" filtroCampo="id_compromiso" filtroOperador="=" filtroValor="$inParam.id_compromiso_anual$"/>
                    <campo name="total_comprometido" calc="%acumula.acumula.acumulado_IR%"/>
                </tabla>
            </componente>
        </nivel>
        <nivel nombre="Reporte Documento Unico del Ejercicio del Presupuesto del Contrato" id="aaa" mostrarNivelAnterior="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true">
            <componente tipo="reporte" nombre="Póliza del Comprometido" id="aaa">
                <reporte nombre="poliza_contable">
                    <campo name="ur" type="long" calc="$inParam.ur$"/>
                    <campo name="periodo" type="long" calc="%bP.bP.id_periodo%"/>
                    <campo name="folio_movimiento_auxiliar" type="long" calc="%nlGenEncabezadoPolizaCom.cpGenEncabezadoPolizaCom.folio_movimiento_auxiliar%"/>
                </reporte>
            </componente>
        </nivel>
        <nivel nombre="barre_compromisos_anual_det" id="bCAd" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true AND %bP.bP.id_mov_adecuacion_compromisos_anuales%==1">
            <componente tipo="cursor" nombre="bCAd" id="bCAd">
                <tabla schema="operation" nombre="compromisos_anual_det" id="aBl" tituloDetalle="Alta de Bloque">
                    <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="%bP.bP.id_unidad_responsable%" columna-visible="false"/>
                    <campo name="id_periodo" filtroCampo="id_periodo" filtroOperador="=" filtroValor="%bP.bP.id_periodo%" columna-visible="false"/>
                    <campo name="id_compromiso" filtroCampo="id_compromiso" filtroOperador="=" filtroValor="%bP.bP.id_compromiso_anual%"/>
                    <campo name="importe_ampliacion_com" calc="0"/>
                    <campo name="importe_ampliacion_com_modificado" calc="0"/>
                    <campo name="prorratear" calc="false"/>
                    <campo name="importexmes" calc="0"/>
                    <campo name="por_calendarizar" calc="0"/>
                    <campo name="mes_act" calc=""/>
                </tabla>
            </componente>
        </nivel>
        <nivel nombre="barre_compromisos_anual_det" id="bCAd_Reduccion" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true AND %bP.bP.id_mov_adecuacion_compromisos_anuales%==2">
            <componente tipo="cursor" nombre="bCAd" id="bCAd_Reduccion">
                <tabla schema="operation" nombre="compromisos_anual_det" id="aBl" tituloDetalle="Alta de Bloque">
                    <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="%bP.bP.id_unidad_responsable%" columna-visible="false"/>
                    <campo name="id_periodo" filtroCampo="id_periodo" filtroOperador="=" filtroValor="%bP.bP.id_periodo%" columna-visible="false"/>
                    <campo name="id_compromiso" filtroCampo="id_compromiso" filtroOperador="=" filtroValor="%bP.bP.id_compromiso_anual%"/>
                    <campo name="importe_reduccion_com" calc="0"/>
                    <campo name="importe_reduccion_com_modificado" calc="0"/>
                    <campo name="prorratear" calc="false"/>
                    <campo name="importexmes" calc="0"/>
                    <campo name="por_calendarizar" calc="0"/>
                    <campo name="mes_act" calc=""/>
                </tabla>
            </componente>
        </nivel>
        <nivel nombre="Finaliza Instancia" id="finalizaInstancia" interactivo="false" ejecutar="%aCA.aCA.autorizacion_adecuacion_com%==true">
            <componente tipo="solicitud" nombre="finalizaInstancia" id="finalizaInstancia" >
                <parametros url="$config.request$" metodo="POST" accion="terminarInstancia" tipo="json">
                    <parametro name="enterprise" calc="$protocolarios.enterprise$"/>
                    <parametro name="process" calc="$protocolarios.process$"/>
                    <parametro name="version" calc="$protocolarios.version$"/>
                    <parametro name="instance" calc="$protocolarios.instance$"/>
                </parametros>
            </componente>
        </nivel>
    </pagina>
</tarea>