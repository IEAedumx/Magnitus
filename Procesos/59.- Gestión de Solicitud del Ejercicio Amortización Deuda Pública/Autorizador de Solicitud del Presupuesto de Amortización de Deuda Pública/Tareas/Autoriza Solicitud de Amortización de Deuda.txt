<tarea autor="dood" fechaModificacion="" id="ddd" modificacionEfectuada="Versión Inicial" nombre="Autoriza solicitud de amortización de deuda pública" requisitosInstalacion="No" version="1.0.1">
    <pagina nombre="Autoriza solicitud de amortización de deuda pública" id="1">
        <nivel interactivo="false" id="params" nombre="parametros">
            <componente tipo="cursor" id="params" nombre="parametros">
                <tabla schema="catalog" nombre="dummy">
                    <campo name="id" filtroCampo="id" filtroOperador="=" filtroValor="1" />
                    <campo name="ur" local="true" type="long" calc="$inParam.ur$" />
                    <campo name="periodo" local="true" type="long" calc="$inParam.periodo$" />
                    <campo name="amortizacion_dp" local="true" type="long" calc="$inParam.amortizacion_dp$" />
                </tabla>
            </componente>
        </nivel>
        <nivel id="usuario" nombre="Busca usuario" interactivo="false">
            <componente id="usuario" nombre="Busca usuario" tipo="cursor">
                <tabla schema="entity" nombre="usuario">
                    <campo name="id_unidad_responsable" text="UR" filtroCampo="id_unidad_responsable" filtroOperador="=" filtroValor="%params.params.id_unidad_responsable%" />
                    <campo name="nombre_usuario" filtroCampo="nombre_usuario" filtroOperador="=" filtroValor="$protocolarios.user$" />
                    <campo name="id_usuario" />
                </tabla>
            </componente>
        </nivel>
        <nivel id="genSolEjeAmorDp" nombre="Autoriza Solicitud de Ejercicio de Amortizacion de Deuda Pública" mostrarProximoNivel="true" mostrarNivelAnterior="false">
            <componente id="genSolEjeAmorDp" nombre="Autoriza Solicitud de Ejercicio de Amortizacion de Deuda Pública" tipo="maestroDetalle">
                <encabezado accionDefault="editar">
                    <tabla schema="operation" nombre="amortizacion_dp">
                        <campo name="ur" calc="%params.params.ur%" llaveForanea="false" visible="false" />
                        <campo name="periodo" calc="%params.params.periodo%" llaveForanea="false" visible="false" />
                        <campo name="id_amortizacion_dp" calc="%params.params.amortizacion_dp%" visible="false" />
                        <campo name="id_fudep" llaveForanea="false" visible="false" />
                        <campo name="folio_duep" text="DDEP" habilitado="false" columnas="3" margen-izquierdo="2" />
                        <campo name="tipo_amortizacion" text="Tipo de amortización" descripcionForanea="descripcion" columnas="3" margen-derecho="2" habilitado="false" />
                        <campo name="id_beneficiario" text="Beneficiario" descripcionForanea="folio_beneficiario,razon_social" habilitado="false" llavesFijas="id_estatus_beneficiario=1" validacion="%id_beneficiario%==null" validacionMensaje="Seleccione Beneficiario" columnas="3" margen-izquierdo="2" />
                        <campo name="numero_amortizacion" text="Número Amortización" descripcionForanea="numero_amortizacion" habilitado="false" columnas="3" margen-derecho="2" />
                        <campo name="id_cat_centro" calc="2" llaveForanea="false" visible="false" />
                        <campo name="centro_registro" text="Centro de registro" habilitado="false" descripcionForanea="id_cat,descripcion" columnas="3" margen-izquierdo="2" validacion="%centro_registro%==null" validacionMensaje="Seleccione Unidad Ejecutora" />
                        <campo name="id_cat_fondo" calc="3" llaveForanea="false" visible="false" />
                        <campo name="fondo_contable" text="Fondo contable" habilitado="false" descripcionForanea="descripcion" columnas="3" margen-derecho="2" validacion="%fondo_contable%==null" validacionMensaje="Seleccione Fondo Contable" />
                        <campo name="fecha_registro" text="Fecha" habilitado="false" columnas="3" margen-izquierdo="2" />
                        <campo name="id_cat_fuente" calc="5" llaveForanea="false" visible="false" />
                        <campo name="fuente_financiamiento" habilitado="false" text="Fuente de financiamiento" descripcionForanea="descripcion" columnas="3" margen-derecho="2" />
                        <campo name="concepto" text="Concepto" height="200" habilitado="false" columnas="6" margen-izquierdo="2" margen-derecho="2" validacion="%concepto%==null" validacionMensaje="Capture Concepto" />-->
                        <campo name="estatus" calc="'EN PROCESO'" visible="false" />
                    </tabla>
                    <estilos>
                        <boton nombre="grabar" visible="false" margen-izquierdo="4" columnas="2" margen-derecho="4" />
                    </estilos>
                </encabezado>
                <detalles>
                    <tabla id="detGenSolEjeAmorDp" schema="operation" nombre="amortizacion_dp_det" tituloDetalle="Renglón" mostrarEditar="false" mostrarAgregar="false" mostrarEliminar="false">
                        <campo name="ur" llaveForanea="false" columna-visible="false" visible="false" />
                        <campo name="periodo" llaveForanea="false" columna-visible="false" visible="false" />
                        <campo name="id_amortizacion" llaveForanea="false" columna-visible="false" visible="false" />
                        <campo name="id_amortizacion_det" autogenerado="true" generacion="@prox()+1" text="Bloque" columnas="3" margen-izquierdo="2" width="100" />
                        <campo name="tipo_bloque" text="Tipo de Renglón" descripcionForanea="descripcion" columnas="3" margen-derecho="2" validacion="%tipo_bloque%==null" validacionMensaje="Seleccione un tipo de bloque" />
                        <campo name="tipo_comprobante" text="Tipo de Comprobante" columnas="3" margen-izquierdo="2" validacion="%tipo_comprobante%==null" validacionMensaje="Seleccione Tipo de Comprobante" columna-visible="false" />
                        <campo name="id_proveedor" text="Proveedor" marcador="Seleccione un proveedor" descripcionForanea="folio_beneficiario,razon_social" descripcionForaneaTabla="folio_beneficiario,razon_social" columna-visible="false" interaccion-visible="%tipo_detalle%==1" columnas="3" margen-derecho="2" />
                        <campo name="clave_articulo" text="Articulo" descripcionForaneaTabla="clave_articulo,descripcion_articulo" autoFiltrado="true" maxlength="50" autoFiltradoDescripcion="clave_articulo,descripcion_articulo" interaccion-visible="%tipo_bloque%==1" validacion="%tipo_bloque%==1 AND %clave_articulo%==null" validacionMensaje="Seleción Artículo" columnas="3" margen-izquierdo="2" width="100" />
                        <campo name="descripcion_especifica" text="Descripción Específica" columnas="3" margen-derecho="2" width="100" />
                        <campo name="clasificador_objeto" text="Clasificador por Objeto del Gasto " habilitado="false" interaccion-visible="%tipo_bloque%==1" calcCliente="@consultaDirec('SELECT clasificador_objeto_gasto_clave as cog FROM catalog.articulos WHERE ur='+%barrido.barrido.id_unidad_responsable%+' AND periodo='+%barrido.barrido.id_periodo%+' AND clave_articulo='+'\\''+%clave_articulo%+'\\'','cog','string','MAGNITUS')" columnas="3" margen-izquierdo="2" width="100" />
                        <campo name="id_cat_progpre" text="Id cat programa" llaveForanea="false" calc="10" visible="false" columna-visible="false" />
                        <campo name="programa_presupuestal" text="Programa Presupuestal" autoFiltrado="true" maxlength="50" autoFiltradoDescripcion="id_cat,descripcion" descripcionForanea="id_cat,descripcion" interaccion-visible="%tipo_bloque%==1" validacion="%tipo_bloque%==1 AND %programa_presupuestal%==null" validacionMensaje="Selecione Programa Presupuestal" columnas="3" margen-derecho="2" width="100" />
                        <campo name="clave_presupuestal" text="Clave Presupuestal" interaccion-visible="%tipo_bloque%==1" habilitado="false" calcCliente="@ifThenElse(%tipo_bloque%==1,@concatenar(@ifThenElse(%genSolEjeAmorDp.genSolEjeAmorDp.centro_registro%==null,'',%genSolEjeAmorDp.genSolEjeAmorDp.centro_registro%)+' '+@ifThenElse(%genSolEjeAmorDp.genSolEjeAmorDp.fondo_contable%==null,'',%genSolEjeAmorDp.genSolEjeAmorDp.fondo_contable%)+' '+@ifThenElse(%clasificador_objeto%==null,'',%clasificador_objeto%)+' '+@ifThenElse(%genSolEjeAmorDp.genSolEjeAmorDp.fuente_financiamiento%==null,'',%genSolEjeAmorDp.genSolEjeAmorDp.fuente_financiamiento%)+' '+@ifThenElse(%programa_presupuestal%==null,'',%programa_presupuestal%)),'')" margen-izquierdo="2" columnas="3" />
                        <campo name="folio_comprobante" text="Folio de Comprobante" interaccion-visible="%tipo_bloque%==1" validacion="%tipo_bloque%==1 AND %folio_comprobante%==null" validacionMensaje="Capture Folio de Comprobante" columnas="3" margen-derecho="2" />
                        <campo name="cantidad" text="Cantidad" interaccion-visible="%tipo_bloque%==1" validacion="%tipo_bloque%==1 AND %cantidad%==null" validacionMensaje="Capture la Cantidad de Artículos Requeridos" columnas="3" margen-izquierdo="2" />
                        <campo name="indicador" text="Indicador" calcCliente="@consultaDirec('SELECT idp.descripcion as descripcion FROM catalog.catalogos cat INNER JOIN catalog.programa_presupuestario pp ON cat.id_cat = pp.id_cat INNER JOIN catalog.ficha_indicador fi ON pp.id_cat = fi.id_cat INNER JOIN catalog.indicador_tipo idp ON idp.id_tipo = fi.tipo WHERE cat.id_cat='+'\\''+%programa_presupuestal%+'\\''+' AND cat.id_catalogo = 10','descripcion','string','MAGNITUS')" habilitado="false" columna-visible="false" visible="false" />
                        <campo name="id_unidad_medida" text="Unidad de Medida" descripcionForaneaTabla="descripcion" descripcionForanea="descripcion" interaccion-visible="%tipo_bloque%==1" validacion="%genSolEjeAmorDp.genSolEjeAmorDp.tipo_bloque%==1 AND %id_unidad_medida%==null" validacionMensaje="Indique Unidad de Medida" columnas="3" margen-derecho="2" />
                        <campo name="precio_unitario" text="Precio Unitario" muestraAcumulado="true" formatoMoneda="true" interaccion-visible="%tipo_bloque%==1" columnas="3" margen-izquierdo="2" columna-visible="false" />
                        <campo name="descuento" text="Descuento" muestraAcumulado="true" formatoMoneda="true" interaccion-visible="%tipo_bloque%==1" validacion="%tipo_bloque%==1 AND %descuento%==null" columnas="3" margen-derecho="2" columna-visible="false" />
                        <campo name="otros_impuestos" text="Otros Impuestos" muestraAcumulado="true" formatoMoneda="true" interaccion-visible="%tipo_bloque%==1" validacion="%tipo_bloque%==1 AND %otros_impuestos%==null" columnas="3" margen-izquierdo="2" columna-visible="false" />
                        <campo name="genero_contable" text="Genero Contable" interaccion-visible="%tipo_bloque%==2" validacion="%tipo_bloque%==2 AND %genero_contable%==null" validacionMensaje="Seleccione Género Contable" columnas="3" margen-derecho="2" columna-visible="false">
                            <opciones>
                                <opcion valor="Activo" texto="Activo" />
                                <opcion valor="Pasivo" texto="Pasivo" />
                            </opciones>
                        </campo>
                        <campo name="tipo_afectacion" text="Tipo de Afectación" calcCliente="@ifThenElse(%genero_contable%==null,'',@ifThenElse(%genero_contable%!='Activo','Incremento de Pásivo','Disminución de Activo'))" habilitado="false" interaccion-visible="%tipo_bloque%==2" columnas="3" margen-izquierdo="2" />
                        <campo name="tipo_operacion" text="Operación" descripcionForanea="tipo_operacion" interaccion-visible="%tipo_bloque%==2" columna-visible="false" columnas="3" margen-derecho="2" />
                        <campo name="importe_unitario" text="Importe Unitario" calcCliente="@ifThenElse(%tipo_bloque%==1,((@ifThenElse(%precio_unitario%==null,0,%precio_unitario%)*1.16)+(%otros_impuestos%-%descuento%)),%importe_unitario%)" interaccion="%tipo_bloque%==2" validacion="%genSolEjeAmorDp.genSolEjeAmorDp.tipo_bloque%==2 AND %genSolEjeAmorDp.genSolEjeAmorDp.importe_unitario%==null" columnas="3" margen-izquierdo="2" />
                        <campo name="importe_total" text="Importe Total" muestraAcumulado="true" campoCondicionAcumulado="tipo_bloque==2" calcCliente="@ifThenElse(%tipo_bloque%==2,(@ifThenElse(%importe_unitario%==null,0,%importe_unitario%)),(@ifThenElse(%cantidad%==null,0,%cantidad%)*@ifThenElse(%importe_unitario%==null,0,%importe_unitario%)))" visible="false" />
                        <campo name="estatus" calc="'EN PROCESO'" visible="false" columna-visible="false" />
                    </tabla>
                </detalles>
            </componente>
        </nivel>
        <nivel nombre="Reporte Solicitud de Ejercicio de Amortización de Deuda Pública" id="RSEADP" mostrarNivelAnterior="false">
            <componente tipo="reporte" nombre="Reporte Solicitud de Ejercicio de Amortización de Deuda Pública" id="RSEADP">
                <reporte nombre="repor_sol_deup_jsus">
                    <campo name="ur" type="long" local="true" calc="%genSolEjeAmorDp.genSolEjeAmorDp.ur%" />
                    <campo name="periodo" type="long" local="true" calc="%genSolEjeAmorDp.genSolEjeAmorDp.periodo%" />
                    <campo name="id_amortizacion_dp" type="long" local="true" calc="%genSolEjeAmorDp.genSolEjeAmorDp.id_amortizacion_dp%"/>
                </reporte>
            </componente>
        </nivel>
        <nivel nombre="Autoriza Solicitud Solicitud de Ejercicio de Amortización de Deuda Pública" id="ESEADP" mostrarProximoNivel="false" mostrarNivelAnterior="false">
            <componente tipo="formulario" nombre="Autoriza Solicitud Solicitud de Ejercicio de Amortización de Deuda Pública" id="ESEADP" accionDefault="editar">
                <tabla schema="operation" nombre="amortizacion_dp">
                    <campo name="ur" calc="%params.params.ur%" llaveForanea="false" visible="false" habilitado="false" />
                    <campo name="periodo" calc="%params.params.periodo%" llaveForanea="false" visible="false" habilitado="false" />
                    <campo name="id_amortizacion_dp" calc="%params.params.amortizacion_dp%" visible="false" habilitado="false" />
                    <campo name="autoriza" text="Autoriza" local="true" type="bool" columnas="3" margen-derecho="4" margen-izquierdo="4" />
                    <campo name="observaciones_aut" text="Observaciones" columnas="6" interaccion="%autoriza%==false" height="200" margen-izquierdo="2" margen-derecho="2" />
                </tabla>
                <estilos>
                    <boton nombre="grabar" visible="true" texto="Guardar" columnas="3" margen-derecho="4" margen-izquierdo="4" />
                </estilos>
                <acciones>
                    <accion nombre="grabar" hacer="saltar siguiente nivel" />
                </acciones>
            </componente>
        </nivel>
        <nivel nombre="TurnarInstancia" id="EnlaceDynamo" interactivo="false" ejecutar="%ESEADP.ESEADP.autoriza%==false">
            <componente tipo="solicitud" nombre="Enlace con dynamo" id="EnlaceDynamo">
                <parametros url="$config.request$" metodo="POST" accion="negociarInstancia" tipo="json">
                    <parametro name="enterprise" calc="$protocolarios.enterprise$" />
                    <parametro name="process" calc="$protocolarios.process$" />
                    <parametro name="version" calc="$protocolarios.version$" />
                    <parametro name="instance" calc="$protocolarios.instance$" />
                    <parametro name="user" calc="$protocolarios.user$" />
                    <parametro name="url" calc="$protocolarios.url$" />
                    <parametro name="reiniciarInstancia" calc="'true'" />
                </parametros>
            </componente>
        </nivel>
        <nivel nombre="Instancia Validador" id="InstanciaVal" interactivo="false" ejecutar="%ESEADP.ESEADP.autoriza%==false">
            <componente tipo="solicitud" nombre="EnvioParametrosDynamo" id="InstanciaVal">
                <parametros url="$config.request$" metodo="POST" accion="agregarMensaje" tipo="json">
                    <parametro name="enterprise" calc="$protocolarios.enterprise$" />
                    <parametro name="process" calc="$protocolarios.process$" />
                    <parametro name="version" calc="$protocolarios.version$" />
                    <parametro name="user" calc="$protocolarios.user$" />
                    <parametro name="instanceId" calc="$protocolarios.instance$" />
                    <parametro name="message" calc="%ESEADP.ESEADP.observaciones_aut%" />
                    <parametro name="type" calc="'1'" />
                </parametros>
            </componente>
        </nivel>
        <nivel interactivo="false" id="actual" nombre="actualizacion" ejecutar="%ESEADP.ESEADP.autoriza%==true">
            <componente tipo="cursor" id="actual" nombre="actualizacion">
                <tabla schema="operation" nombre="amortizacion_dp">
                    <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="%params.params.ur%" />
                    <campo name="periodo" filtroCampo="periodo" filtroOperador="=" filtroValor="%params.params.periodo%" />
                    <campo name="id_amortizacion_dp" filtroCampo="id_amortizacion_dp" filtroOperador="=" filtroValor="%params.params.amortizacion_dp%" />
                    <campo name="estatus" calc="'AUTORIZADO'" />
                </tabla>
                <nivel interactivo="false" id="esta" nombre="estatus" ejecutar="%actual.actual.ur%!=null">
                    <componente tipo="cursor" id="esta" nombre="estatus">
                        <tabla schema="operation" nombre="amortizacion_dp_det">
                            <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="%actual.actual.ur%" />
                            <campo name="periodo" filtroCampo="periodo" filtroOperador="=" filtroValor="%actual.actual.periodo%" />
                            <campo name="id_amortizacion" filtroCampo="id_amortizacion" filtroOperador="=" filtroValor="%actual.actual.id_amortizacion_dp%" />
                            <campo name="id_amortizacion_det" />
                            <campo name="estatus" calc="'AUTORIZADO'" />
                        </tabla>
                    </componente>
                </nivel>
            </componente>
        </nivel>
        <nivel id="obtSep" nombre="Obtener Separador" interactivo="false" ejecutar="%ESEADP.ESEADP.autoriza%==true">
            <componente tipo="cursor" id="obtSep" nombre="Obtener Separador">
                <tabla schema="catalog" nombre="periodo">
                    <campo name="id_unidad_responsable" filtroCampo="id_unidad_responsable" filtroOperador="=" filtroValor="%params.params.ur%" />
                    <campo name="id_periodo" filtroCampo="id_periodo" filtroOperador="=" filtroValor="%params.params.periodo%" />
                    <campo name="id_separador" />
                </tabla>
            </componente>
        </nivel>
        <nivel id="obtCar" nombre="Obtener Caracter" interactivo="false" ejecutar="%ESEADP.ESEADP.autoriza%==true">
            <componente tipo="cursor" id="obtCar" nombre="Obtener Caracter">
                <tabla schema="catalog" nombre="separador">
                    <campo name="id_separador" filtroCampo="id_separador" filtroOperador="=" filtroValor="%obtSep.obtSep.id_separador%" />
                    <campo name="caracter" />
                </tabla>
            </componente>
        </nivel>
        <nivel nombre="Poliza 1" id="encPol1" interactivo="false" ejecutar="%ESEADP.ESEADP.autoriza%==true">
            <componente tipo="cursor" nombre="Poliza 1" id="encPol1">
                <tabla schema="operation" nombre="amortizacion_dp">
                    <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="%params.params.ur%" />
                    <campo name="periodo" filtroCampo="periodo" filtroOperador="=" filtroValor="%params.params.periodo%" />
                    <campo name="id_amortizacion_dp" filtroCampo="id_amortizacion_dp" filtroOperador="=" filtroValor="%params.params.amortizacion_dp%" />
                    <campo name="id_fudep" />
                    <campo name="folio_duep" />
                </tabla>
            </componente>
        </nivel>
        <nivel nombre="Genera Poliza 1" id="genPol1" interactivo="false" ejecutar="%ESEADP.ESEADP.autoriza%==true">
            <componente tipo="altaDirect" nombre="Genera Poliza 1" id="genPol1">
                <tabla schema="operation" nombre="movimientos_auxiliares">
                    <campo name="ur" calc="%params.params.ur%" />
                    <campo name="periodo" calc="%params.params.periodo%" />
                    <campo name="folio_movimiento_auxiliar" generacion="@prox()+1" autogenerado="true" />
                    <campo name="fecha_poliza" calc="@fechaSistema()" />
                    <campo name="momento_contable" calc="4" />
                    <campo name="estatus_poliza" calc="2" />
                    <campo name="tipo_poliza" calc="1" />
                    <campo name="origen_poliza" calc="1"/>
                    <campo name="duep_origen" calc="%encPol1.encPol1.id_fudep%" />
                    <campo name="folio_reporte" calc="@concatenar(%params.params.perido%+'-'+@ifThenElse(%folio_movimiento_auxiliar%&lt;10,'00000',@ifThenElse(%folio_movimiento_auxiliar%&lt;100,'0000',@ifThenElse(%folio_movimiento_auxiliar%&lt;1000,'000',@ifThenElse(%folio_movimiento_auxiliar%&lt;10000,'00',@ifThenElse(%folio_movimiento_auxiliar%&lt;100000,'0',null)))))+%folio_movimiento_auxiliar%)" />
                    <campo name="ultimo_usuario_modificador" calc="%usuario.usuario.id_usuario%" />
                    <campo name="concepto_general" calc="@concatenar('Póliza del Presupuesto de Egresos Comprometidos de la Solicitud del Ejercicio Directo '+%encPol1.encPol1.folio_duep%)" />
                </tabla>
            </componente>
        </nivel>
        <nivel nombre="Agregar Cargo Poliza 1" id="carPol1" interactivo="false" ejecutar="%ESEADP.ESEADP.autoriza%==true">
            <componente tipo="cursor" nombre="Agregar Cargo Poliza 1" id="carPol1">
                <tabla schema="operation" nombre="amortizacion_dp_det">
                    <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="%params.params.ur%" />
                    <campo name="periodo" filtroCampo="periodo" filtroOperador="=" filtroValor="%params.params.periodo%" />
                    <campo name="id_amortizacion" filtroCampo="id_amortizacion" filtroOperador="=" filtroValor="%params.params.amortizacion_dp%" />
                    <campo name="id_amortizacion_det" />
                    <campo name="importe_total" />
                    <campo name="clave_articulo" />
                    <campo name="clave_presupuestal" />
                    <campo name="tipo_bloque" filtroCampo="tipo_bloque" filtroOperador="=" filtroValor="1" />
                </tabla>
                <nivel id="carImpor_1" nombre="agregar importe" interactivo="false" ejecutar="%carPol1.carPol1.ur%!=null">
                    <componente tipo="altaDirect" id="carImpor_1" nombre="agregar importe">
                        <tabla schema="operation" nombre="detalle_movimientos_auxiliares">
                            <campo name="ur" calc="%params.params.ur%" />
                            <campo name="id_periodo" calc="%params.params.periodo%" />
                            <campo name="id_movimiento_auxiliar" calc="%genPol1.genPol1.folio_movimiento_auxiliar%" />
                            <campo name="id_detalle_movimiento_auxiliar" autogenerado="true" generacion="@prox()+1" />
                            <campo name="clave_cuenta_contable" calc="@concatenar('8'+%obtCar.obtCar.caracter%+'2'+%obtCar.obtCar.caracter%+'4'+%obtCar.obtCar.caracter%+'0'+%obtCar.obtCar.caracter%+'0')" />
                            <campo name="importe_cargo" calc="%carPol1.carPol1.importe_total%" />
                            <campo name="concepto_bloque" calc="%carPol1.carPol1.clave_articulo%" />
                            <campo name="clave_presupuestal" calc="%carPol1.carPol1.clave_presupuestal%" />
                            <campo name="ultimo_usuario_modificador" calc="%usuario.usuario.id_usuario%" />
                            <campo name="fecha_registro" calc="@fechaSistema()" />
                            <campo name="tipo_detalle" calc="1" />
                        </tabla>
                    </componente>
                </nivel>
                <nivel id="carAbon_1" nombre="agregar importe" interactivo="false">
                    <componente tipo="altaDirect" id="carAbon_1" nombre="agregar importe">
                        <tabla schema="operation" nombre="detalle_movimientos_auxiliares">
                            <campo name="ur" calc="%params.params.ur%" />
                            <campo name="id_periodo" calc="%params.params.periodo%" />
                            <campo name="id_movimiento_auxiliar" calc="%genPol1.genPol1.folio_movimiento_auxiliar%" />
                            <campo name="id_detalle_movimiento_auxiliar" autogenerado="true" generacion="@prox()+1" />
                            <campo name="clave_cuenta_contable" calc="@concatenar('8'+%obtCar.obtCar.caracter%+'2'+%obtCar.obtCar.caracter%+'2'+%obtCar.obtCar.caracter%+'0'+%obtCar.obtCar.caracter%+'0')" />
                            <campo name="importe_abono" calc="%carPol1.carPol1.importe_total%" />
                            <campo name="concepto_bloque" calc="%carPol1.carPol1.clave_articulo%" />
                            <campo name="clave_presupuestal" calc="%carPol1.carPol1.clave_presupuestal%" />
                            <campo name="ultimo_usuario_modificador" calc="%usuario.usuario.id_usuario%" />
                            <campo name="fecha_registro" calc="@fechaSistema()" />
                            <campo name="tipo_detalle" calc="1" />
                        </tabla>
                    </componente>
                </nivel>
            </componente>
        </nivel>
        <nivel id="noPresupuestal" nombre="barreImportesDetalle" interactivo="false">
            <componente id="noPresupuestal" nombre="barreImportesDetalle" tipo="cursor">
                <tabla schema="operation" nombre="amortizacion_dp_det">
                    <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="%params.params.ur%"/>
                    <campo name="periodo" filtroCampo="periodo" filtroOperador="=" filtroValor="%params.params.periodo%"/> 
                    <campo name="id_amortizacion" filtroCampo="id_amortizacion" filtroOperador="=" filtroValor="%params.params.amortizacion_dp%"/>
                    <campo name="id_amortizacion_det" />
                    <campo name="tipo_bloque" filtroCampo="tipo_bloque" filtroOperador="=" filtroValor="2"/>
                    <campo name="importe_total"/>
                    <campo name="acumulado" local="true" type="decimal" calc="$sumatoria.importe_total$"/>
                    <campo name="tipo_operacion"/>
                </tabla>
            </componente>
        </nivel>
        <nivel id="barreClaveRetencion" nombre="barreClaveRetencion" interactivo="false">
            <componente id="barreClaveRetencion" nombre="barreClaveRetencion" tipo="cursor">
                <tabla schema="catalog" nombre="tipos_operacion">
                    <campo name="id_tipo_operacion" filtroCampo="id_tipo_operacion" filtroOperador="=" filtroValor="%noPresupuestal.noPresupuestal.tipo_operacion%"/>
                    <campo name="clave_cuenta_cont"/>
                </tabla>
            </componente>
        </nivel>
        <nivel nombre="Genera Poliza 2" id="genPol2" interactivo="false" ejecutar="%ESEADP.ESEADP.autoriza%==true">
            <componente tipo="altaDirect" nombre="Genera Poliza 2" id="genPol2">
                <tabla schema="operation" nombre="movimientos_auxiliares">
                    <campo name="ur" calc="%params.params.ur%" />
                    <campo name="periodo" calc="%params.params.periodo%" />
                    <campo name="folio_movimiento_auxiliar" generacion="@prox()+1" autogenerado="true" />
                    <campo name="fecha_poliza" calc="@fechaSistema()" />
                    <campo name="momento_contable" calc="2" />
                    <campo name="estatus_poliza" calc="2" />
                    <campo name="tipo_poliza" calc="1" />
                    <campo name="origen_poliza" calc="1"/>
                    <campo name="duep_origen" calc="%encPol1.encPol1.id_fudep%" />
                    <campo name="folio_reporte" calc="@concatenar(%params.params.perido%+'-'+@ifThenElse(%folio_movimiento_auxiliar%&lt;10,'00000',@ifThenElse(%folio_movimiento_auxiliar%&lt;100,'0000',@ifThenElse(%folio_movimiento_auxiliar%&lt;1000,'000',@ifThenElse(%folio_movimiento_auxiliar%&lt;10000,'00',@ifThenElse(%folio_movimiento_auxiliar%&lt;100000,'0',null)))))+%folio_movimiento_auxiliar%)" />
                    <campo name="ultimo_usuario_modificador" calc="%usuario.usuario.id_usuario%" />
                    <campo name="concepto_general" calc="@concatenar('Póliza del Presupuesto de Egresos Devengados de la Solicitud del Ejercicio Directo '+%encPol1.encPol1.folio_duep%)" />
                </tabla>
            </componente>
        </nivel>
        <nivel nombre="Agregar Cargo Poliza 2" id="carPol2" interactivo="false" ejecutar="%ESEADP.ESEADP.autoriza%==true">
            <componente tipo="cursor" nombre="Agregar Cargo Poliza 1" id="carPol2">
                <tabla schema="operation" nombre="amortizacion_dp_det">
                    <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="%params.params.ur%" />
                    <campo name="periodo" filtroCampo="periodo" filtroOperador="=" filtroValor="%params.params.periodo%" />
                    <campo name="id_amortizacion" filtroCampo="id_amortizacion" filtroOperador="=" filtroValor="%params.params.amortizacion_dp%" />
                    <campo name="id_amortizacion_det" />
                    <campo name="importe_total" />
                    <campo name="tipo_bloque" filtroCampo="tipo_bloque" filtroOperador="=" filtroValor="1" />
                    <campo name="clave_presupuestal" />
                    <campo name="clave_articulo" />
                </tabla>
                <nivel id="arti" nombre="Barre Presupuesto de Egresos Mensual" interactivo="false">
                    <componente id="arti" nombre="Barre Presupuesto de Egresos Mensual" tipo="cursor">
                        <tabla schema="catalog" nombre="articulos">
                            <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="%params.params.ur%" />
                            <campo name="periodo" filtroCampo="periodo" filtroOperador="=" filtroValor="%params.params.periodo%" />
                            <campo name="clave_articulo" filtroCampo="clave_articulo" filtroOperador="=" filtroValor="%carPol2.carPol2.clave_articulo%" />
                            <campo name="cuenta_contable" />
                            <campo name="descripcion_cuenta_contable" />
                        </tabla>
                    </componente>
                </nivel>
                <nivel id="carImpor_2" nombre="agregar importe" interactivo="false">
                    <componente tipo="altaDirect" id="carImpor_2" nombre="agregar importe">
                        <tabla schema="operation" nombre="detalle_movimientos_auxiliares">
                            <campo name="ur" calc="%params.params.ur%" />
                            <campo name="id_periodo" calc="%params.params.periodo%" />
                            <campo name="id_movimiento_auxiliar" calc="%genPol2.genPol2.folio_movimiento_auxiliar%" />
                            <campo name="id_detalle_movimiento_auxiliar" autogenerado="true" generacion="@prox()+1" />
                            <campo name="clave_cuenta_contable" calc="@concatenar('8'+%obtCar.obtCar.caracter%+'2'+%obtCar.obtCar.caracter%+'5'+%obtCar.obtCar.caracter%+'0'+%obtCar.obtCar.caracter%+'0')" />
                            <campo name="importe_cargo" calc="%carPol2.carPol2.importe_total%" />
                            <campo name="concepto_bloque" calc="%carPol2.carPol2.clave_articulo%" />
                            <campo name="clave_presupuestal" calc="%carPol2.carPol2.clave_presupuestal%" />
                            <campo name="ultimo_usuario_modificador" calc="%usuario.usuario.id_usuario%" />
                            <campo name="fecha_registro" calc="@fechaSistema()" />
                            <campo name="tipo_detalle" calc="1" />
                        </tabla>
                    </componente>
                </nivel>
                <nivel id="carAbon_1_1" nombre="agregar importe" interactivo="false">
                    <componente tipo="altaDirect" id="carAbon_1_1" nombre="agregar importe">
                        <tabla schema="operation" nombre="detalle_movimientos_auxiliares">
                            <campo name="ur" calc="%params.params.ur%" />
                            <campo name="id_periodo" calc="%params.params.periodo%" />
                            <campo name="id_movimiento_auxiliar" calc="%genPol2.genPol2.folio_movimiento_auxiliar%" />
                            <campo name="id_detalle_movimiento_auxiliar" autogenerado="true" generacion="@prox()+1" />
                            <campo name="clave_cuenta_contable" calc="@concatenar('8'+%obtCar.obtCar.caracter%+'2'+%obtCar.obtCar.caracter%+'4'+%obtCar.obtCar.caracter%+'0'+%obtCar.obtCar.caracter%+'0')" />
                            <campo name="importe_abono" calc="%carPol2.carPol2.importe_total%" />
                            <campo name="concepto_bloque" calc="%carPol2.carPol2.clave_articulo%" />
                            <campo name="clave_presupuestal" calc="%carPol2.carPol2.clave_presupuestal%" />
                            <campo name="ultimo_usuario_modificador" calc="%usuario.usuario.id_usuario%" />
                            <campo name="fecha_registro" calc="@fechaSistema()" />
                            <campo name="tipo_detalle" calc="1" />
                        </tabla>
                    </componente>
                </nivel>
                <!-- Presupuestales-->

                <!-- Patrimoniales-->
                <nivel id="cargoCuenta" nombre="cargoCuenta" interactivo="false">
                    <componente id="cargoCuenta" nombre="cargoCuenta" tipo="altaDirect">
                        <tabla schema="operation" nombre="detalle_movimientos_auxiliares">
                            <campo name="ur" calc="%params.params.ur%" />
                            <campo name="id_periodo" calc="%params.params.periodo%" />
                            <campo name="id_movimiento_auxiliar" calc="%genPol2.genPol2.folio_movimiento_auxiliar%" />
                            <campo name="id_detalle_movimiento_auxiliar" generacion="@prox()+1" autogenerado="true" />
                            <campo name="clave_presupuestal" calc="%carPol2.carPol2.clave_presupuestal%" />
                            <campo name="clave_cuenta_contable" calc="%arti.arti.cuenta_contable%" />
                            <campo name="importe_cargo" calc="%carPol2.carPol2.importe_total%" />
                            <campo name="concepto_bloque" calc="%carPol2.carPol2.clave_articulo%" />
                            <campo name="fecha_registro" calc="@fechaSistema()" />
                            <campo name="ultimo_usuario_modificador" calc="%usuario.usuario.id_usuario%" />
                            <campo name="tipo_detalle" calc="2" llaveForanea="false" />
                        </tabla>
                    </componente>
                </nivel>
                <nivel id="abonoCuenta" nombre="abonoCuenta" interactivo="false">
                    <componente id="abonoCuenta" nombre="abonoCuenta" tipo="altaDirect">
                        <tabla schema="operation" nombre="detalle_movimientos_auxiliares">
                            <campo name="ur" calc="%params.params.ur%" />
                            <campo name="id_periodo" calc="%params.params.periodo%" />
                            <campo name="id_movimiento_auxiliar" calc="%genPol2.genPol2.folio_movimiento_auxiliar%" />
                            <campo name="id_detalle_movimiento_auxiliar" generacion="@prox()+1" autogenerado="true" />
                            <campo name="clave_presupuestal" calc="%carPol2.carPol2.clave_presupuestal%" />
                            <campo name="clave_cuenta_contable" calc="'2-1-1-2-0-001-01-001'" />
                            <campo name="importe_abono" calc="%carPol2.carPol2.importe_total% - @ifThenElse(%noPresupuestal.noPresupuestal.acumulado%==null,0,@castTo(%noPresupuestal.noPresupuestal.acumulado%,'float'))" />
                            <campo name="concepto_bloque" calc="%carPol2.carPol2.clave_articulo%" />
                            <campo name="fecha_registro" calc="@fechaSistema()" />
                            <campo name="ultimo_usuario_modificador" calc="%usuario.usuario.id_usuario%" />
                            <campo name="tipo_detalle" calc="2" llaveForanea="false" />
                        </tabla>
                    </componente>
                </nivel>
              <!--  <nivel id="cargoCuentaRetencion" nombre="cargoCuentaRetencion" interactivo="false">
                    <componente id="cargoCuentaRetencion" nombre="cargoCuentaRetencion" tipo="altaDirect">
                        <tabla schema="operation" nombre="detalle_movimientos_auxiliares">
                            <campo name="ur" calc="%params.params.ur%"/>
                            <campo name="id_periodo" calc="%params.params.periodo%"/>
                            <campo name="id_movimiento_auxiliar" calc="%genPol2.genPol2.folio_movimiento_auxiliar%" />
                            <campo name="id_detalle_movimiento_auxiliar" generacion="@prox()+1" autogenerado="true"/>
                            <campo name="clave_presupuestal" calc="%carPol2.carPol2.clave_presupuestal%"/>
                            <campo name="clave_cuenta_contable" calc="%barreClaveRetencion.barreClaveRetencion.clave_cuenta_cont%"/>
                            <campo name="importe_abono" calc="%noPresupuestal.noPresupuestal.acumulado%"/>
                            <campo name="concepto_bloque" calc="%carPol2.carPol2.articulo%"/>
                            <campo name="referencia" calc="%arti.arti.descripcion_cuenta_contable%"/>
                            <campo name="fecha_registro" calc="@fechaSistema()" />
                            <campo name="ultimo_usuario_modificador" calc="%usuario.usuario.id_usuario%"/>
                            <campo name="tipo_detalle" calc="2" llaveForanea="false"/>
                        </tabla>
                    </componente>
                </nivel>-->
            </componente>
        </nivel>

        <!--<nivel nombre="Agregar Abono Poliza 2" id="abnPol2" interactivo="false" ejecutar="%ESEADP.ESEADP.autoriza%==true">
            <componente tipo="cursor" nombre="Agregar Abono Poliza 2" id="abnPol2">
                <tabla schema="operation" nombre="amortizacion_dp_det">
                    <campo name="ur" filtroCampo="ur" filtroOperador="=" filtroValor="%params.params.ur%"/>
                    <campo name="periodo" filtroCampo="ur" filtroOperador="=" filtroValor="%params.params.periodo%"/>
                    <campo name="id_amortizacion" filtroCampo="ur" filtroOperador="=" filtroValor="%params.params.id_amortizacion%"/>
                    <campo name="id_amortizacion_det"/>
                    <campo name="importe_total"/>
                </tabla>

                <nivel id="carImpor_3" nombre="agregar importe" interactivo="false">
                    <componente tipo="altaDirect" id="carImpor_3" nombre="agregar importe">
                        <tabla schema="operation" nombre="detalle_movimientos_auxiliares">
                            <campo name="ur" calc="%params.params.ur%" />
                            <campo name="id_periodo" calc="%params.params.periodo%" />
                            <campo name="id_movimiento_auxiliar" calc="%genPol2.genPol2.folio_movimiento_auxiliar%" />
                            <campo name="id_detalle_movimiento_auxiliar" autogenerado="true" generacion="@prox()+1" />
                            <campo name="clave_cuenta_contable" calc="@concatenar('8'+%obtCar.obtCar.caracter%+'2'+%obtCar.obtCar.caracter%+'5'+%obtCar.obtCar.caracter%+'0'+%obtCar.obtCar.caracter%+'0'+%obtCar.obtCar.caracter%+'0')" />
                            <campo name="importe_abono" calc="%carPol1.carPol1.importe_total%" />
                            <campo name="concepto_bloque" calc="%genSolEjeAmorDp.genSolEjeAmorDp.clave_articulo%" />
                            <campo name="clave_presupuestal" calc="%genSolEjeAmorDp.genSolEjeAmorDp.clave_presupuestal%"/>
                            <campo name="ultimo_usuario_modificador" calc="%usuario.usuario.id_usuario%" />
                            <campo name="fecha_registro" calc="@fechaSistema()" />
                            <campo name="tipo_detalle" calc="1" />
                        </tabla>
                    </componente>
                </nivel>
                <nivel id="carAbon_3" nombre="agregar importe" interactivo="false">
                    <componente tipo="altaDirect" id="carAbon_3" nombre="agregar importe">
                        <tabla schema="operation" nombre="detalle_movimientos_auxiliares">
                            <campo name="ur" calc="%params.params.ur%" />
                            <campo name="id_periodo" calc="%params.params.periodo%" />
                            <campo name="id_movimiento_auxiliar" calc="%genPol2.genPol2.folio_movimiento_auxiliar%" />
                            <campo name="id_detalle_movimiento_auxiliar" autogenerado="true" generacion="@prox()+1" />
                            <campo name="clave_cuenta_contable" calc="@concatenar('8'+%obtCar.obtCar.caracter%+'2'+%obtCar.obtCar.caracter%+'4'+%obtCar.obtCar.caracter%+'0'+%obtCar.obtCar.caracter%+'0'+%obtCar.obtCar.caracter%+'0')" />
                            <campo name="importe_cargo" calc="%carPol1.carPol1.importe_total%" />
                            <campo name="concepto_bloque" calc="%genSolEjeAmorDp.genSolEjeAmorDp.clave_articulo%"/>
                            <campo name="clave_presupuestal" calc="%genSolEjeAmorDp.genSolEjeAmorDp.clave_presupuestal%"/>
                            <campo name="ultimo_usuario_modificador" calc="%usuario.usuario.id_usuario%" />
                            <campo name="fecha_registro" calc="@fechaSistema()" />
                            <campo name="tipo_detalle" calc="1" />
                        </tabla>
                    </componente>
                </nivel>
            </componente>
        </nivel>-->

        <nivel id="PCdD" nombre="Reporte de la Póliza" ejecutar="%ESEADP.ESEADP.autoriza%==true" mostrarNivelAnterior="false">
            <componente tipo="reporte" nombre="Poliza Contable de Amortización de Deuda Pública" id="PCdD">
                <reporte nombre="poliza_contable">
                    <campo name="ur" calc="%params.params.ur%" type="long" />
                    <campo name="periodo" calc="%params.params.periodo%" type="long" />
                    <campo name="folio_movimiento_auxiliar" calc="%genPol1.genPol1.folio_movimiento_auxiliar%" type="long" />
                </reporte>
            </componente>
            <componente tipo="reporte" nombre="Poliza Contable de Amortización de Deuda Pública" id="PCdD2">
                <reporte nombre="poliza_contable">
                    <campo name="ur" calc="%params.params.ur%" type="long" />
                    <campo name="periodo" calc="%params.params.periodo%" type="long" />
                    <campo name="folio_movimiento_auxiliar" calc="%genPol2.genPol2.folio_movimiento_auxiliar%" type="long" />
                </reporte>
            </componente>
        </nivel>

        <nivel id="terminarInstancia" nombre="terminarInstancia" interactivo="false" ejecutar="%ESEADP.ESEADP.autoriza%==true">
            <componente id="terminarInstancia" nombre="terminarInstancia" tipo="solicitud">
                <parametros url="$config.request$" metodo="POST" accion="terminarInstancia" tipo="json">
                    <parametro name="enterprise" calc="$protocolarios.enterprise$" />
                    <parametro name="process" calc="$protocolarios.process$" />
                    <parametro name="version" calc="$protocolarios.version$" />
                    <parametro name="instance" calc="$protocolarios.instance$" />
                    <parametro name="user" calc="$protocolarios.user$" />
                    <parametro name="url" calc="$protocolarios.url$" />
                </parametros>
            </componente>
        </nivel>
    </pagina>
</tarea>